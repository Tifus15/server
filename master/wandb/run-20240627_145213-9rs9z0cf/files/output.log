100%|██████████| 224/224 [00:00<00:00, 11767.00it/s]
  0%|          | 0/26 [00:00<?, ?it/s]]
  0%|          | 0/100 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/work/scratch/da35hevy/server-graph-models/master/main.py", line 58, in <module>
    run_experiment(experiment)
  File "/work/scratch/da35hevy/experiment_launcher/experiment_launcher/launcher.py", line 485, in run_experiment
    func(**args)
  File "/work/scratch/da35hevy/experiment_launcher/experiment_launcher/decorators.py", line 35, in wrapper
    exp_func(*args, **kwargs)
  File "/work/scratch/da35hevy/server-graph-models/master/main.py", line 53, in experiment
    full(configs)
  File "/work/scratch/da35hevy/server-graph-models/master/main_body.py", line 423, in full
    train6body(configs)
  File "/work/scratch/da35hevy/server-graph-models/master/main_body.py", line 156, in train6body
    predy = model(ts,x0)
            ^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/scratch/da35hevy/server-graph-models/master/GRU_model.py", line 196, in forward
    xi = self.GNN(xi.squeeze())
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/scratch/da35hevy/server-graph-models/master/GRU_model.py", line 153, in forward
    return self.net(y.float())
           ^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/scratch/da35hevy/server-graph-models/master/GRU_model.py", line 93, in forward
    self.g.ndata["h"] = self.NN(feat)
                        ^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/da35hevy/.conda/envs/hnn/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (48x128 and 4x128)
DEBUG MODE: False
Config file content:
{'model': 'GCN', 'sob': True, 'sob_a': 0.01, 'a': 0.01, 'opti': 'adamW', 'reg': 'none', 'loss': 'Huber', 'acts': ['tanh', None], 'epochs': 100, 'modelsize': 128, 'batchsize': 8, 'timesize': 32, 'lr': 0.0005, 'split': 0.9, 'device': 'cpu', 'single': True}
/work/scratch/da35hevy/server-graph-models/master
6body
100
torch.Size([256, 100, 6, 1])
torch.Size([256, 100, 6, 4])
torch.Size([256, 100, 6, 4])
[0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5]
[0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5]
torch.Size([256, 1, 6, 9])
torch.Size([256, 1, 6, 9])
224 snapshots
torch.Size([32, 6, 9])
converting
224
rollout_GNN_GRU_inverted(
  (GRU): GRU(128, 4)
  (GNN): GNN_maker(
    (net): Sequential(
      (0): GNNlayer(
        (NN): Linear(in_features=4, out_features=128, bias=True)
      )
      (1): Tanh()
      (2): GNNlayer(
        (NN): Linear(in_features=128, out_features=128, bias=True)
      )
    )
  )
)
TRAIN